---
description: PROJECT MEMORY - READ THIS BEFORE ANSWERING
globs: 
---

# ðŸ›¡ï¸ Project Guardian: HVA Memory

> **DO NOT DELETE OR IGNORE THIS FILE.**
> This file is the "Long Term Memory" of the project.
> It contains the Source of Truth for tech stack, file structure, and current state.

---

## ðŸ—ï¸ Tech Stack (The "No-Go" Zone)

> **CRITICAL:** Do NOT suggest changes to these unless explicitly asked.

| Layer | Technology | Details |
|-------|------------|---------|
| **Frontend** | React 19 + Vite | TailwindCSS, Lucide React |
| **Desktop** | Electron 39 | `desktop/` folder |
| **Backend** | Python FastAPI | `api/` folder, Uvicorn |
| **AI/Voice** | Faster Whisper | `haitham_voice_agent/` |
| **Database** | ChromaDB | Vector store for memory |

---

## ðŸ—ºï¸ File Map (Where things live)

> **CRITICAL:** Do NOT create new files outside these conventions.

```
/Users/haitham/development/Haitham Voice Agent (HVA)/
â”œâ”€â”€ desktop/                  # Electron + React Frontend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/            # UI Pages (ChatView.jsx)
â”‚   â”‚   â”œâ”€â”€ components/       # Reusable UI
â”‚   â”‚   â”œâ”€â”€ context/          # Global State (WebSocketContext)
â”‚   â”‚   â””â”€â”€ services/         # API Client (api.js)
â”‚   â”œâ”€â”€ main.js               # Electron Main Process
â”‚   â””â”€â”€ package.json          # Frontend Deps
â”œâ”€â”€ api/                      # FastAPI Backend
â”‚   â”œâ”€â”€ routes/               # API Endpoints (voice, chat, files)
â”‚   â””â”€â”€ main.py               # Server Entry Point
â”œâ”€â”€ haitham_voice_agent/      # Core AI Logic
â”‚   â”œâ”€â”€ tools/                # Tools (files, voice, memory)
â”‚   â”œâ”€â”€ llm_router.py         # LLM Decision Logic
â”‚   â””â”€â”€ dispatcher.py         # Tool Execution
â””â”€â”€ start_hva.sh              # Startup Script
```

---

## ðŸš¦ Running Now (Don't start duplicates!)

| Service | Port | Command | Status |
|---------|------|---------|--------|
| **Backend** | `8765` | `./start_hva.sh` | âœ… Running |
| **Frontend** | `5173` | `npm run dev` | âœ… Running |

---

## ðŸ“ Change Management Rules

### 1. PURE_UI_STYLE (Low Risk)
*Examples: Colors, spacing, text changes, CSS tweaks.*
- **Action:** Just do it. No deep planning needed.

### 2. UI_BEHAVIOUR_TWEAK (Medium Risk)
*Examples: Button clicks, form validation, loading states.*
- **Action:** Check `api.js` first. Ensure backend supports it.

### 3. NEW_FEATURE_FLOW (High Risk)
*Examples: New page, new API route, new tool.*
- **Action:**
  1. **Plan:** Create/Update `implementation_plan.md`
  2. **Review:** Ask user for approval
  3. **Execute:** Implement step-by-step

---

## ðŸ› Known Issues (Don't rediscover them)

- **Voice/Chat Sync:** Bot sometimes responds before transcript appears (Fix in progress).
- **Microphone:** Sometimes gets stuck if stop signal isn't received (Fixed via WebSocketContext).

---

## ðŸ”„ Recent Changes (Context)

- **[2025-12-03]** Added `files` tool and API route for opening files.
- **[2025-12-03]** Fixed `FileTools` to include directories and handle aliases (download -> Downloads).
- **[2025-12-03]** Integrated Voice & Chat into unified UI (`ChatView.jsx`).
- **[2025-12-03]** Created `WebSocketContext` for global voice state.
- **[2025-12-03]** Updated Dashboard header font size to `text-5xl` (PURE_UI_STYLE).

---

## ðŸ’¬ When Unsure

> "I see [X] in the project memory. Before I proceed:
> - Is [server] currently running on port [PORT]?
> - Should I modify [existing file] or create new?"

**Never assume. Always verify.**
